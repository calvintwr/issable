/*!
 * issable v0.1.0
 * (c) 2021 calvintwr
 * Release under MIT license.
 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Issable=t()}}((function(){var t={};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t){return null==t||"string"==typeof t||"number"==typeof t?String(t):t.length||Array.isArray(t)||"[object Object]"===String(t)?JSON.stringify(t):"undefined"!=typeof HTMLElement&&t instanceof HTMLElement?"<"+t.nodeName.toLowerCase()+">":"undefined"!=typeof Text&&t instanceof Text?'"'+t.nodeValue+'"':t.toString?t.toString():String(t)};var e={};Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){return t.indexOf(e)>-1&&t.indexOf(e)===t.length-e.length};var r={};Object.defineProperty(r,"__esModule",{value:!0}),r.optionalReplace=void 0;var n=function(t){return function(e){return e.substring(0,e.length-t.length)}};r.optionalReplace=n;var o={};Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(t){return t.replace("$$custom_optional","optional(null or undefined)").replace("$$custom_","custom:")};var i={};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(t,e){return void 0===e&&(e={opinionatedOnNaN:!0,opinionatedOnArray:!0,opinionatedOnNull:!0}),"object"!=a(t)?"number"==typeof t&&isNaN(t)?!1===e.opinionatedOnNaN?["nan","number"]:"nan":a(t):Array.isArray(t)?!1===e.opinionatedOnArray?["array","object"]:"array":null===t?!1===e.opinionatedOnNull?["null","object"]:"null":"object"};var s={},u=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(s,"__esModule",{value:!0});var c=u(o);s.default=function(t,e){if(void 0===e&&(e="or"),"string"==typeof t&&(t=[t]),1===(t=t.map((function(t){return"`"+t.toLowerCase()+"`"}))).length)return c.default(t[0]);if(2===t.length)return c.default(t.join(" "+e+" "));var r=t.slice(0,-1).join(", ")+" "+e+" "+t.slice(-1);return c.default(r)};var f={};Object.defineProperty(f,"__esModule",{value:!0}),f.default=function(t,e,r,n,o,i){return{message:t,expect:e,got:r,gotType:n,name:o,note:i,timestamp:(new Date).getTime()}};var l={};Object.defineProperty(l,"__esModule",{value:!0}),l.default=["string","number","array","object","function","boolean","null","undefined","symbol","nan"];var d={};function p(t){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h,y=(h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(d,"__esModule",{value:!0});var m=function(t){function e(r,n,o){var i=this.constructor;void 0===n&&(n=400);var a=this,s="string"==typeof r?r:r.message;return(a=t.call(this,s)||this).name="TypeError (NotTS)",a.statusCode=n,"object"==p(r)&&(a.trace=r,"function"==typeof o&&o(r)),function(t,e,r,n){if(void 0===n&&(n=Error),Object.setPrototypeOf(t,r.prototype),e===r)if(t.name||(t.name=e.name),n.captureStackTrace)n.captureStackTrace(t,r);else{var o=new n(t.message).stack;o&&(t.stack=function(t,e,r){if(!t)return t;if(!e)return t;var n=new RegExp("\\s+at\\s"+e+"\\s");return t.split("\n").filter((function(t){return!t.match(n)})).join("\n")}(o,"new "+e.name,t.trace))}}(a,i,e,TypeError),a}return y(e,t),e}(TypeError);d.default=m;var v={};function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var _=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(v,"__esModule",{value:!0});var g=_(t),O=_(e),w=_(o),j=_(i),P=_(s),k=_(f),T=_(l),N=_(d),S={timestamp:!1,messageInPOJO:!1,_primitives:T.default,_lodged:[],opinionatedOnNaN:!0,opinionatedOnArray:!0,opinionatedOnNull:!0,_isOpinionated:!0,get isOpinionated(){return this._isOpinionated},set isOpinionated(t){this.opinionatedOnNaN=t,this.opinionatedOnArray=t,this.opinionatedOnNull=t,this._isOpinionated=t},willThrowError:!0,get throw(){return this.willThrowError},set throw(t){this.willThrowError=t},get verbose(){return this.timestamp&&this.messageInPOJO},set verbose(t){this.timestamp=this.messageInPOJO=t},are:function(t,e,r,n){return!this.areNot(t,e,r,n)},_are:function(t,e,r,n){try{return"string"!=typeof this.areNot(t,e,r,n)}catch(o){return!1}},areNot:function(t,e,r,n){t=this.prepareExpect(t);var o=j.default(e,this);if(this.validate(t,e,o))return!1;var i,a=this.msg(t,e,o,r,n);if(this.willThrowError)throw"object"==b(a)?(i=new N.default(a.message)).trace=a:i=new N.default(a),i;return a},create:function(t){var e=Object.create(this);return e._lodged=[],t&&this._applyOptions(e,t),e},createNot:function(t){var e=Object.create(this);return e._lodged=[],t&&this._applyOptions(e,t),e.not.bind(e)},createIs:function(t){var e=Object.create(this);return this._applyOptions(e,t),e.are.bind(e)},checkObject:function(t,e,r,n){this.areNot("string",t),this.areNot("object",e),this.areNot("object",r),this.areNot(["function","object","optional"],n);var o=Object.create(this);if("function"==typeof n)return o.walkObject(t,e,r),o.resolve(n,null);if("object"==b(n)){var i=null;return!0===n.returnPayload?"$$empty$$"===(i=o.walkObject(t,e,r,!0,n.exact))&&(i=null):o.walkObject(t,e,r,null,n.exact),n="function"==typeof n.callback?n.callback:this.throw?function(t,e){if(t){var r=new N.default("Wrong types provided. See `trace`.");throw"boolean"!=typeof t&&(r.trace=t),r}return e}:function(t,e){return t||e},o.resolve(n,i)}return o.walkObject(t,e,r),o.resolve()},customExpectHdlr:function(t,e){if(-1===this._primitives.indexOf(e)){if(void 0!==this["$$custom_"+e])return t.push("$$custom_"+e),t;throw new N.default("Internal error: `"+e+"` is not a valid type to check for.")}return t.push(e),t},defineType:function(t){var e=this,r=S.checkObject("defineType",{primitive:["string","array"],type:"string",pass:["function","optional"]},t,{returnPayload:!0});if(Array.isArray(r))throw r.forEach((function(t){console.error(t)})),new N.default("Wrong inputs for #defineType.");"string"==typeof r.primitive&&(r.primitive=[r.primitive]),r.primitive.forEach((function(t){if(-1===e._primitives.indexOf(t))throw new N.default("Internal error: `"+t+"` is not a valid primitive.")}));var n="$$custom_"+r.type;this[n]={primitive:r.primitive},r.pass&&(this[n].pass=r.pass)},msg:function(t,e,r,n,o){var i=P.default(r),a="Wrong Type";return a+=n?" ("+n+")":"",a+=": Expecting type "+P.default(t)+" but got "+i,a+=["`null`","`undefined`","`nan`"].indexOf(i)>-1?".":" with value of `"+g.default(e)+"`.",a+=o?" Note: "+o+".":"",this.timestamp&&(a+=" (TS: "+(new Date).getTime()+")"),this.messageInPOJO?k.default(a,t,e,r,n,o):a},msgProp:function(t,e,r,n){var o=r?" ("+r+")":"";return o+="Property",o+=t?" `"+t+"` is missing.":" `"+e+"` exists but is not expected.",o+=n?" Note: "+n+".":"",this.timestamp&&(o+=" (TS: "+(new Date).getTime()+")"),!this.willThrowError&&this.messageInPOJO?k.default(o,t,e,void 0,r,n):o},validate:function(t,e,r){"string"==typeof r&&(r=[r]);for(var n=!1,o=0;o<t.length;o++){var i=t[o];if(i.indexOf("$$")>-1){if(this._are(this[i].primitive,e,w.default(i))){if("function"==typeof this[i].pass){if(this[i].pass(e)){n=!0;break}continue}n=!0;break}}else if(-1!==r.indexOf(i)){n=!0;break}}return n},lodge:function(t,e,r,n){this.hasOwnProperty("_lodged")||(this._lodged=[]);var o=this._lodged,i=!1;try{i=this.areNot(t,e,r,n)}catch(a){i=a.message}return i&&o.push(i),i},lodgeProp:function(t,e,r,n){this.hasOwnProperty("_lodged")||(this._lodged=[]);var o=this.msgProp(t,e,r,n);return this._lodged.push(o),o},prepareExpect:function(t){var e=this;if("string"==typeof t)t=[t];else if(!Array.isArray(t)){var r="Internal error: Say what you expect to check as a string or array of strings.";throw r+=" Found "+P.default(j.default(t,this),"as")+".",new N.default(r)}return t.reduce((function(t,r){if("string"!=typeof r)throw new N.default("Internal error: Say what you expect to check as a string. Found "+P.default(j.default(r,e),"as")+".");return r=r.toLowerCase(),e.customExpectHdlr(t,r)}),[])},resolve:function(t,e){var r=this._lodged,n=this.willThrowError;if(0===r.length)return"function"==typeof t&&t(!1,e);var o=r.slice();if(this._lodged=[],"function"==typeof t)return t(o,e);if(n){var i=new N.default("Wrong types provided. See `trace`.");throw i.trace=o,i}return o},walkObject:function(t,e,n,o,i){var a=this;if(o)var s={};var u=Object.keys(e);i&&Object.keys(n).filter((function(t){return!u.includes(t)})).forEach((function(e){a.lodgeProp(!1,(t?t+".":"")+e)}));for(var c=0,f=u;c<f.length;c++){var l=f[c],d=e[l],p=!1;O.default(l,"?")?p=r.optionalReplace("?"):O.default(l,"__optional")&&(p=r.optionalReplace("__optional"));var h=p?p(l):l;if(h in n||p){var y=n[h];if("object"!=b(d)||null===d||Array.isArray(d)){p&&(Array.isArray(d)?d.push("optional"):d=[d,"optional"]);var m=this.lodge(d,y,(t?t+".":"")+h);o&&!m&&y&&(s[h]=y)}else{if("object"==b(y)&&null!==y&&!Array.isArray(d)){if("$$empty$$"===this.walkObject((t?t+".":"")+h,d,y,o))continue;o&&(s[h]=y);continue}if(p)continue;this.lodge("object",y,(t?t+".":"")+h)}}else this.lodgeProp((t?t+".":"")+h)}if(o)return Object.keys(s).length<1?"$$empty$$":s},_applyOptions:function(t,e){var r=this;if(this._are("object",e)){if(this._are("boolean",e.willThrowError)&&(console.warn("NotJS: Use of `willThrowError` is deprecated. Use `throw` insteead."),t.willThrowError=e.willThrowError),this._are("boolean",e.throw)&&(t.throw=e.throw),this._are("boolean",e.verbose)&&(t.verbose=e.verbose),this._are("boolean",e.timestamp)&&(t.timestamp=e.timestamp),this._are("boolean",e.messageInPOJO)&&(t.messageInPOJO=e.messageInPOJO),this._are("boolean",e.isOpinionated))return void(t.isOpinionated=e.isOpinionated);Object.keys(S).filter((function(t){return 0===t.indexOf("opinionatedOn")})).forEach((function(n){r._are("boolean",e[n])&&(t[n]=e[n])}))}},not:function(t,e,r,n){return this.areNot(t,e,r,n)},is:function(t,e,r,n){return this.are(t,e,r,n)},scrub:function(t,e,r,n){return this.checkObject(t,e,r,{returnPayload:!0,exact:n})},NotTypeError:N.default};v.default=S,v=S;var E={};Object.defineProperty(E,"__esModule",{value:!0});var x={primitive:["null","undefined"]},$=function(t){return t.$$custom_optional=x,t};E.default=$,E=$;var M={};Object.defineProperty(M,"__esModule",{value:!0});var A={primitive:["number"],pass:function(t){return t.toFixed(0)===t.toString()}},I=function(t){return t.$$custom_integer=A,t};M.default=I,M=I;var C={},J=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(C,"__esModule",{value:!0});var L=J(v),R=J(E),F=J(M);R.default(L.default),F.default(L.default),C.default=L.default;var H={};H=H=C=C=L.default;var W={},D=function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(W,"__esModule",{value:!0}),W.define=W.not=W.is=void 0;var U=D(H),V=function(t,e){return void 0===e&&(e="Anonymous param"),{candidate:t,_name:e,throw:!0,operator:"is",exact:!1,_statusCode:400,_msg:"",_checker:function(t){try{U.default.is(t,this.candidate,this._name,this._msg)}catch(e){if("not"===this.operator)return!0;throw this._errorModifier(e),e}if("is"===this.operator)return!0;if("not"===this.operator){var e=new U.default.NotTypeError("".concat(this._name," is of type ").concat(t,"."));throw this._errorModifier(e),e}throw Error("Fatal: Operator should only be `is` or `not`.")},string:function(){return this._checker("string")},number:function(){return this._checker("number")},array:function(){return this._checker("array")},boolean:function(){return this._checker("boolean")},function:function(){return this._checker("function")},null:function(){return this._checker("null")},undefined:function(){return this._checker("undefined")},symbol:function(){return this._checker("symbol")},nan:function(){return this._checker("nan")},optional:function(){return this._checker("optional")},integer:function(){return this._checker("integer")},object:function(r){if(void 0===r)try{return U.default.is("object",this.candidate,this._name,this._msg)}catch(o){throw this._errorModifier(o),o}try{U.default.is("object",this.candidate),U.default.is("object",r)}catch(o){throw o}if("is"===this.operator){var n;try{n=U.default.scrub(e||"Anonymous Object",r,t,this.exact)}catch(o){throw this._errorModifier(o),o}return n}if("not"===this.operator){try{U.default.scrub("",r,t,!0)}catch(o){return this.candidate}var o=new U.default.NotTypeError("Payload is not the same as defined schema for ".concat(this._name));throw this._errorModifier(o),o}},custom:function(t){return this._checker(t)},safe:function(){return this.throw=!1,this},statusCode:function(t){return this._statusCode=t,this},not:function(){return this.operator="not",this},msg:function(t){return this._msg=t,this},name:function(t){return this._name=t,this},_errorModifier:function(t){if(t.statusCode=this._statusCode,this._msg&&this._msg.length>0){var e="";this._name&&(e+="(Param: ".concat(this._name,")")),e+=" ".concat(this._msg),t.message=e}return t.name=t.name.replace("(NotTS)","(Issable)"),t}}};return W.is=V,W.not=function(t,e){var r=V(t,e);return r.operator="not",r},W.define=function(t){U.default.defineType({primitive:t.primitives,type:t.nameOfTyping,pass:t.toPass})},W.default=V,W}));